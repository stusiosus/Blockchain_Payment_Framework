<mxfile host="app.diagrams.net" modified="2024-05-08T11:37:49.745Z" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36" etag="zhC4wYKYjLhGnAIvJF8S" version="24.3.1" type="github">
  <diagram id="C5RBs43oDa-KdzZeNtuy" name="Page-1">
    <mxGraphModel dx="1038" dy="591" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-0" />
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-1" parent="WIyWlLk6GJQsqaUBKTNV-0" />
        <mxCell id="YgNDyVswAlzfiliHHgwm-14" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="40" y="30" width="1370" height="670" as="geometry" />
        </mxCell>
        <mxCell id="zkfFHV4jXpPFQw0GAbJ--0" value="Device" style="swimlane;fontStyle=2;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeLast=0;collapsible=1;marginBottom=0;rounded=0;shadow=0;strokeWidth=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="640" y="150" width="350" height="285" as="geometry">
            <mxRectangle x="230" y="140" width="160" height="26" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="zkfFHV4jXpPFQw0GAbJ--1" value="+ id : uint256" style="text;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="zkfFHV4jXpPFQw0GAbJ--0" vertex="1">
          <mxGeometry y="26" width="350" height="26" as="geometry" />
        </mxCell>
        <mxCell id="zkfFHV4jXpPFQw0GAbJ--2" value="+ name : string " style="text;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rounded=0;shadow=0;html=0;" parent="zkfFHV4jXpPFQw0GAbJ--0" vertex="1">
          <mxGeometry y="52" width="350" height="26" as="geometry" />
        </mxCell>
        <mxCell id="zkfFHV4jXpPFQw0GAbJ--4" value="" style="line;html=1;strokeWidth=1;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" parent="zkfFHV4jXpPFQw0GAbJ--0" vertex="1">
          <mxGeometry y="78" width="350" height="8" as="geometry" />
        </mxCell>
        <mxCell id="zkfFHV4jXpPFQw0GAbJ--5" value="+ addAction(name)&#xa;+ removedevice ownlyOwner()&#xa;+ createAction onlyOwner(name,unit,pricePerUnit) &#xa;+ sendFundsCreditForWholeDevice modifieer_has_nft(amount)&#xa;+ addToOrganisation  modifier_has_nft (id) &#xa;" style="text;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="zkfFHV4jXpPFQw0GAbJ--0" vertex="1">
          <mxGeometry y="86" width="350" height="164" as="geometry" />
        </mxCell>
        <mxCell id="zkfFHV4jXpPFQw0GAbJ--17" value="Action" style="swimlane;fontStyle=0;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeLast=0;collapsible=1;marginBottom=0;rounded=0;shadow=0;strokeWidth=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1070" y="180" width="280" height="330" as="geometry">
            <mxRectangle x="1070" y="180" width="160" height="26" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="zkfFHV4jXpPFQw0GAbJ--18" value="+ id : uint256" style="text;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="zkfFHV4jXpPFQw0GAbJ--17" vertex="1">
          <mxGeometry y="26" width="280" height="26" as="geometry" />
        </mxCell>
        <mxCell id="zkfFHV4jXpPFQw0GAbJ--19" value="+ name : string" style="text;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rounded=0;shadow=0;html=0;" parent="zkfFHV4jXpPFQw0GAbJ--17" vertex="1">
          <mxGeometry y="52" width="280" height="26" as="geometry" />
        </mxCell>
        <mxCell id="zkfFHV4jXpPFQw0GAbJ--20" value="+ unit : string" style="text;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rounded=0;shadow=0;html=0;" parent="zkfFHV4jXpPFQw0GAbJ--17" vertex="1">
          <mxGeometry y="78" width="280" height="26" as="geometry" />
        </mxCell>
        <mxCell id="zkfFHV4jXpPFQw0GAbJ--21" value="+ pricePerUnit : uint32" style="text;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rounded=0;shadow=0;html=0;" parent="zkfFHV4jXpPFQw0GAbJ--17" vertex="1">
          <mxGeometry y="104" width="280" height="26" as="geometry" />
        </mxCell>
        <mxCell id="zkfFHV4jXpPFQw0GAbJ--22" value="+ DeviceId : uint256" style="text;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;rounded=0;shadow=0;html=0;" parent="zkfFHV4jXpPFQw0GAbJ--17" vertex="1">
          <mxGeometry y="130" width="280" height="26" as="geometry" />
        </mxCell>
        <mxCell id="zkfFHV4jXpPFQw0GAbJ--23" value="" style="line;html=1;strokeWidth=1;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" parent="zkfFHV4jXpPFQw0GAbJ--17" vertex="1">
          <mxGeometry y="156" width="280" height="8" as="geometry" />
        </mxCell>
        <mxCell id="zkfFHV4jXpPFQw0GAbJ--24" value="+ getUnits()&#xa;+ getPrice()&#xa;+ sendFundsCredit (amount) &#xa;+ recieveFunds (amount)&#xa;+ setPrice onlyOwner (price)&#xa;+ checkIotConfirmation(mqtt message)&#xa;- withdrawFromUser ()&#xa;- checkEnoughtFunds()&#xa;" style="text;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="zkfFHV4jXpPFQw0GAbJ--17" vertex="1">
          <mxGeometry y="164" width="280" height="166" as="geometry" />
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-9" value="mqtt message:&lt;div&gt;{&lt;/div&gt;&lt;div&gt;device_id:1,&lt;/div&gt;&lt;div&gt;action_id:1,&lt;/div&gt;&lt;div&gt;amount_in_unit:1hr,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1550" y="30" width="270" height="150" as="geometry" />
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-12" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="40" y="750" width="770" height="410" as="geometry" />
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-13" value="contract" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="470" y="790" width="60" height="80" as="geometry" />
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-19" value="Smart Contract Struktur" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="635" y="50" width="250" height="30" as="geometry" />
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-36" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="YgNDyVswAlzfiliHHgwm-38" target="YgNDyVswAlzfiliHHgwm-13" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="530" y="850" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-37" value="call contract:&lt;br&gt;adddevice() +&lt;div&gt;addAction()&lt;/div&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="YgNDyVswAlzfiliHHgwm-36" vertex="1" connectable="0">
          <mxGeometry x="0.0679" y="-2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-38" value="DeviceOwner" style="shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;outlineConnect=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="110" y="800" width="30" height="60" as="geometry" />
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-39" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="40" y="1230" width="770" height="250" as="geometry" />
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-56" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="YgNDyVswAlzfiliHHgwm-55" target="YgNDyVswAlzfiliHHgwm-13" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-57" value="subscribe for Event&amp;nbsp;&lt;br&gt;deviceAdded() +&lt;br&gt;actionAdded()" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="YgNDyVswAlzfiliHHgwm-56" vertex="1" connectable="0">
          <mxGeometry x="0.0412" y="3" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-55" value="Internes Web3 Gateway" style="image;html=1;image=img/lib/clip_art/computers/Server_128x128.png" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="460" y="1020" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-69" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="40" y="1524" width="770" height="450" as="geometry" />
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-70" value="contract" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="730" y="1624" width="60" height="80" as="geometry" />
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-71" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="YgNDyVswAlzfiliHHgwm-73" target="YgNDyVswAlzfiliHHgwm-78" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="240" y="1814" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-72" value="send mqtt confirmation to:&lt;div&gt;pepper / payment&lt;/div&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="YgNDyVswAlzfiliHHgwm-71" vertex="1" connectable="0">
          <mxGeometry x="0.0566" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-73" value="Pepper" style="shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;outlineConnect=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="120" y="1614" width="30" height="60" as="geometry" />
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-74" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" target="YgNDyVswAlzfiliHHgwm-78" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="460" y="1664" as="sourcePoint" />
            <mxPoint x="280" y="1854" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-75" value="Subscribe to:&lt;br&gt;pepper / payment" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="YgNDyVswAlzfiliHHgwm-74" vertex="1" connectable="0">
          <mxGeometry x="-0.0488" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-76" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" target="YgNDyVswAlzfiliHHgwm-70" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="540" y="1664" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-77" value="call contract:&lt;br&gt;checkIotConfirmation" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="YgNDyVswAlzfiliHHgwm-76" vertex="1" connectable="0">
          <mxGeometry x="0.0679" y="-2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-78" value="mqtt broker" style="image;html=1;image=img/lib/clip_art/networking/Print_Server_Wireless_128x128.png" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="190" y="1804" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-79" value="Internes Web3 Gateway" style="image;html=1;image=img/lib/clip_art/computers/Server_128x128.png" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="460" y="1624" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-80" value="-wie bekommt man Nachricht zwischen Iot device und dem web 3 gateway verschlüsselt ,damit man private Key mitschicken kann&amp;nbsp;" style="rounded=0;whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1880" y="240" width="260" height="110" as="geometry" />
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-81" value="- wie verifiziert man,dass das Tatsächliche Iot Gerät Nachricht geschickt hat ?" style="rounded=0;whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1560" y="220" width="200" height="150" as="geometry" />
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-82" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=-0.017;entryY=0.486;entryDx=0;entryDy=0;entryPerimeter=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="YgNDyVswAlzfiliHHgwm-81" target="YgNDyVswAlzfiliHHgwm-80" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-83" value="contract" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="540" y="1309" width="60" height="80" as="geometry" />
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-85" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="YgNDyVswAlzfiliHHgwm-84" target="YgNDyVswAlzfiliHHgwm-83" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="260" y="1349" />
              <mxPoint x="260" y="1349" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-86" value="call contract :&lt;div&gt;&lt;span style=&quot;font-size: 12px; text-align: left; background-color: rgb(251, 251, 251);&quot;&gt;sendFundsCredit()&lt;br&gt;&lt;/span&gt;to subscribe to device Action&lt;/div&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="YgNDyVswAlzfiliHHgwm-85" vertex="1" connectable="0">
          <mxGeometry x="0.027" y="-5" relative="1" as="geometry">
            <mxPoint x="1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-84" value="user" style="shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;outlineConnect=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="140" y="1309" width="30" height="60" as="geometry" />
        </mxCell>
        <mxCell id="6KjZxbrwGnfFm8o-KUSs-1" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="YgNDyVswAlzfiliHHgwm-87" target="6KjZxbrwGnfFm8o-KUSs-0" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="YgNDyVswAlzfiliHHgwm-87" value="ist der Ablauf korrekt ,dass man erst balance abfragt -&amp;gt; weil dann kann z.B. nicht nach stunden und watt abgerechnet werden&amp;nbsp;" style="rounded=0;whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1560" y="410" width="200" height="130" as="geometry" />
        </mxCell>
        <mxCell id="6KjZxbrwGnfFm8o-KUSs-0" value="&lt;div&gt;beim fahren abrechen sobal keine funds mehr vorhanden sind&amp;nbsp; oder den durchschnitt bilden&amp;nbsp;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1840" y="410" width="200" height="130" as="geometry" />
        </mxCell>
        <mxCell id="6KjZxbrwGnfFm8o-KUSs-2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="zkfFHV4jXpPFQw0GAbJ--22" target="zkfFHV4jXpPFQw0GAbJ--5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6KjZxbrwGnfFm8o-KUSs-8" value="organisation Contract&amp;nbsp;" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="260" y="140" width="240" height="210" as="geometry" />
        </mxCell>
        <mxCell id="6KjZxbrwGnfFm8o-KUSs-9" value="&lt;div&gt;+ id&amp;nbsp;&lt;/div&gt;+ name: string&lt;div&gt;&lt;div&gt;+ deviceId : mapping uint256&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;+ nfts&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="6KjZxbrwGnfFm8o-KUSs-8" vertex="1">
          <mxGeometry y="26" width="240" height="74" as="geometry" />
        </mxCell>
        <mxCell id="6KjZxbrwGnfFm8o-KUSs-10" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;" parent="6KjZxbrwGnfFm8o-KUSs-8" vertex="1">
          <mxGeometry y="100" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="6KjZxbrwGnfFm8o-KUSs-11" value="+ setOrganisation(name)&lt;div&gt;+ removeOrgannisation owner ownly()&lt;br&gt;&lt;div&gt;+ addpeopleToOragnisation()&lt;/div&gt;&lt;/div&gt;&lt;div&gt;+ send_nft ownerOnly()&lt;/div&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;whiteSpace=wrap;html=1;" parent="6KjZxbrwGnfFm8o-KUSs-8" vertex="1">
          <mxGeometry y="130" width="240" height="80" as="geometry" />
        </mxCell>
        <mxCell id="6KjZxbrwGnfFm8o-KUSs-25" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="zkfFHV4jXpPFQw0GAbJ--5" target="6KjZxbrwGnfFm8o-KUSs-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="6KjZxbrwGnfFm8o-KUSs-26" value="organisation (ERC721)" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="250" y="435" width="240" height="56" as="geometry" />
        </mxCell>
        <mxCell id="6KjZxbrwGnfFm8o-KUSs-28" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;" parent="6KjZxbrwGnfFm8o-KUSs-26" vertex="1">
          <mxGeometry y="26" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="6KjZxbrwGnfFm8o-KUSs-30" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.456;entryY=0.989;entryDx=0;entryDy=0;entryPerimeter=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="6KjZxbrwGnfFm8o-KUSs-26" target="6KjZxbrwGnfFm8o-KUSs-11" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="74MWSiRV9Loq3uY4gGZV-0" value="" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1030" y="750" width="970" height="880" as="geometry" />
        </mxCell>
        <mxCell id="74MWSiRV9Loq3uY4gGZV-1" value="&lt;div&gt;1.Case:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;1.&amp;nbsp;Schritt&amp;nbsp;:&amp;nbsp; Admin geht auf Seite und Erstellt Device -&amp;gt; Admin geht auf Device Page und erstellt Action mit namen, messeinheit und Preis pro Messeinheit&lt;div&gt;2. Schritt: User geht auf die Webseite Zahlt Balance auf der Weibseite ein ( ? Frage: auf webseite, Organisation oder Device die Balance einzahlen ?)&amp;nbsp;&lt;/div&gt;&lt;div&gt;3.Schritt: bevor Device die Aktion ausführt wird einmalig abfrage erstellt , ob der user noch genug funds hat um Midestens eine Ausführung der Aktion druchzuführen&lt;/div&gt;&lt;div&gt;4.Schritt: ein lokaler server hört auf mqtt und schickt Anfrage an den Contract&lt;br&gt;&lt;/div&gt;&lt;div&gt;5.Schritt: der Contract überprüft und schickt bestätigung zurück an an den Mqtt zwischenserver,welcher über mqtt witerleitet&lt;/div&gt;&lt;div&gt;6. Schritt: Device führt die Aktion aus und schickt Bestätigungt als json string über Mqtt&amp;nbsp;&lt;/div&gt;&lt;div&gt;7.Schritt: ein lokaler server hört auf mqtt und schickt Bestätigung an&amp;nbsp; den Contract&lt;/div&gt;&lt;div&gt;8.Schritt: Dieser überprüft Bestätigungsjson und zieht die Balance von dem User ab&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;2.Case:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;1.&amp;nbsp;Schritt&amp;nbsp;:&amp;nbsp; Admin geht auf Seite und Erstellt Device -&amp;gt; Admin geht auf Device Page und erstellt Action mit namen, messeinheit und Preis pro Messeinheit&lt;div&gt;2. Schritt: User geht auf die Webseite Zahlt Balance auf der Weibseite ein ( ? Frage: auf webseite, Organisation oder Device die Balance einzahlen ?)&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;3.Schritt: User Klickt im Interface auf die Aktion und Contract schickt eine Event Nachricht raus, dass die Aktion Perfromt werden soll&amp;nbsp;&lt;/div&gt;&lt;div&gt;4.Schritt : lokaler mqtt server hört auf event und Schickt eine Perform Nachricht über mqtt an das Device.&lt;/div&gt;&lt;div&gt;5 Schritt : Device Performt Aktion und schickt anschließend eine bestätigung über mqtt.&lt;/div&gt;&lt;div&gt;6. Schritt : Die Mqtt Nachricht wird mittels des mqtt servers an die Blockchain geschickt,welche anschließend dem User die balance abzieht&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;3.Case:&lt;/div&gt;&lt;div&gt;1.Schritt User legt Organisation An und erstellt somit zwei NFT typen (admin und User NFT)&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- Admin NFT Besitzer&amp;nbsp; erstellt ein Device und eine dazu gehörige Aktion&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;- User NFT Besitzer zahlt in Organisationspool ein&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;- bevor Device die Aktion ausführt wird einmalig abfrage erstellt , ob der user noch genug funds in der Organisation vorhanden sind, um Midestens eine Ausführung der Aktion druchzuführen&lt;/div&gt;&lt;div&gt;- ein lokaler server hört auf mqtt und schickt Anfrage an den Contract&lt;br&gt;&lt;/div&gt;&lt;div&gt;- der Contract überprüft und schickt bestätigung zurück an an den Mqtt zwischenserver,welcher über mqtt witerleitet&lt;/div&gt;&lt;div&gt;- Device führt die Aktion aus und schickt Bestätigung als json string über Mqtt&amp;nbsp;&lt;/div&gt;&lt;div&gt;-&amp;nbsp; ein lokaler server hört auf mqtt und schickt Bestätigung an&amp;nbsp; den Contract&lt;/div&gt;&lt;div&gt;-&amp;nbsp; Dieser überprüft Bestätigungsjson und zieht die Balance von dem User ab&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Ich möchte eine IOT Payment Framework lösung erstellen, welche die Beiden Folgenden Use cases Abbilden soll.&lt;br&gt;Die Anwendung soll aus 6 Solidity Smart Contracten betsehen . Ein Organisations Smart contract,welchem Devices Untergeordnet sind und ein Action Contract,welche dem Device zugeordnet werden sollen .Zusätzlich gibt es zu jedem der Contracte jeweil einen Faktory Contract, welcher einen Contract erstellt und diese in einem Mapping speichert und beabeiten kann.&amp;nbsp;&lt;br&gt;Wie würdest du die Smart contracts aufbauen ,dass sie bei Use Cases bedienen und wie würdest du die Nachrichten aaufbauen und strukturieren ,welche mittels mqqt json string zwischen einem Mqtt server&amp;nbsp; der Blockchain und dem IOT gerät ausgetauscht werden ?&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="1060" y="770" width="900" height="810" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
